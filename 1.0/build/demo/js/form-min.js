/*!build time : 2014-04-20 5:17:11 PM*/
KISSY.add(function(a,b,c,d,e,f){function g(){this._init.apply(this,arguments)}var h=a.Node.all,i=(a.Event,a.DOM,a.UA),j=!0,k={date:{reg:/^((?:(?:19)|(?:2\d))\d{2})[\-\.\/]?((?:10|11|12)|(?:0?[1-9]))[\-\.\/]?((?:0?[1-9])|(?:[12]\d)|(?:30|31))$/g,errmsg:"\u65e5\u671f\u683c\u5f0f\u4e0d\u6b63\u786e",sucmsg:"\u65e5\u671f\u683c\u5f0f\u6b63\u786e"},number:{reg:/^[0-9]{10,16}$/g,errmsg:"\u53ea\u80fd\u4e3a\u6570\u5b57"},range64:{reg:/^(.){0,64}$/g,errmsg:"\u957f\u5ea6\u4e0d\u8d85\u8fc764\uff0c\u4e0d\u5141\u8bb8\u7a7a\u683c"},range50:{reg:/^(.){0,50}$/g,errmsg:"\u957f\u5ea6\u4e0d\u8d85\u8fc750\uff0c\u4e0d\u5141\u8bb8\u7a7a\u683c"},empty:{reg:/(.)|(\n)+/g,errmsg:"\u5fc5\u586b"},email:{reg:/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/,errmsg:"\u90ae\u7bb1\u683c\u5f0f\u4e0d\u6b63\u786e"},txt:{reg:/\.(txt|TXT)$/,errmsg:"\u53ea\u80fd\u662ftxt\u6587\u4ef6"},maxLength:function(a,b){return b.length>a?"\u6700\u5927\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7"+a:void 0},fileSize:function(a){var b=0;if(i.webkit||i.gecko)b=this[0].files[0].size;else{if(!i.trident)return"\u65e0\u6cd5\u83b7\u53d6\u6587\u4ef6\u5927\u5c0f\uff0c\u6587\u4ef6\u5c0f\u4e8e"+a+"K";var c=document.getElementById("tempimg");c.dynsrc=this[0].value,b=c.fileSize}return b/=1024,b>a?"\u4e0a\u4f20\u6587\u4ef6\u4e0d\u80fd\u5927\u4e8e"+a+"K":void 0}},l={attrName:"data-valid",attrTipParent:"data-parent",attrDisable:"data-disable",attrReadonly:"readonly",isReadonly:!1,isAllTip:!0,tipClass:".tip",msg:{tpl:'<div class="tip tip-error">{{msg}}</div>'}};return a.augment(g,{constructor:g,version:"1.0",_init:function(b,c){var d=this;d.cache={},d.cfg=a.merge(l,c),d.$ele=h(b),d.$list=d._getNodeList(d.$ele),d.cache.reg=d.getRegexp(),d._bindEvent()},_getNodeList:function(a){var b=this,c=a.all("input,select,textarea"),d=[],e=b.cfg,f=e.attrName;return c.each(function(a){var b=a.attr(f);b&&d.push(a)}),d},_bindEvent:function(){var b=this;a.each(b.$list,function(a){a.on("blur",function(){"readonly"===a.attr("readonly")||a.fire("keyup")})}),b.$ele.on("keyup",function(a){var c=a.target,d=b.cfg,e=h(c),f=e.attr(d.attrDisable),g=e.attr(d.attrName),i=e.attr(d.attrReadonly);if(g){if("true"==f)return;if(d.isReadonly&&i)return;g&&b._regEvent(e,g)}})},_readonlyEvent:function(){},_regEvent:function(b,c){var d,e=this,f=(e.cfg,e._json(c)),g=e.cache.reg,h=!1;"object"==typeof f&&a.each(f,function(c,i){if(h)return!1;var k=f[i];if("false"!==k){var l,m=b.val().replace(/(^\s*)|(\s*$)/g,""),n=g[i];"object"==typeof n?(l=a.isObject(k)?k:n,-1!=m.search(n.reg)?(l=n.sucmsg?n.sucmsg:"",e._setTpl(b,{msg:l})):(l=l.errmsg?l.errmsg:"",e._setTpl(b,{msg:l}),j=!1,h=!0)):"function"==typeof n&&(d=a.isArray(k)?k.concat(m):[].concat(m),l=n.apply(b,d),l?(j=!1,h=!0):l="",e._setTpl(b,{msg:l}))}})},_json:function(a){return new Function("return"+a)()},_getTpl:function(a){var b=this,c=b.cfg.msg.tpl;return new f(c).render(a)},_removeTpl:function(a){var b=this,c=b.getTip(a.parent());0!=c.length&&b._renderHTML(c,"")},_appendTpl:function(a,b){a.append(b)},_renderHTML:function(a,b){a.html(b)},_setTpl:function(a,b){var c,d,e=this,f=e.cfg,g=!0;if(a.attr(f.attrTipParent)){var i=a.attr(f.attrTipParent);c=e.getTip(h(i)),g=!1}else c=e.getTip(a.parent());0!=c.length?(d=b.msg,e._renderHTML(c,d)):(c=g?e.getTipParent(a):h(i),d=e._getTpl(b),e._appendTpl(c,d))},getTipParent:function(a){return a.parent()},getTip:function(a){return a.all(this.cfg.tipClass)},_getAttr:function(){var b=this,c=b.cfg,d=[];return a.each(b.$list,function(a){var b=new Function("return "+a.attr(c.attrName))();d.push(b)}),d},getRegexp:function(){return k},add:function(){},addRule:function(b){a.mix(k,b)},disable:function(a){var b=this,c=b.cfg,d=h(a);d.val(""),d.attr(c.attrDisable,"true"),b._removeTpl(d)},enable:function(a){var b=this,c=b.cfg,d=h(a);d.attr(c.attrDisable,"false")},valid:function(){{var b=this;b.cfg}return j=!0,arguments[0]?h(arguments[0]).fire("keyup"):a.each(b.$list,function(a){return a.fire("keyup"),b.cfg.isAllTip||1==j?void 0:(a.fire("focus"),!1)}),j}}),g},{requires:["event","node","dom","sizzle","xtemplate"]});