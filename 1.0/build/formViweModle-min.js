/*!build time : 2014-04-20 5:18:09 PM*/
KISSY.add(function(a,b,c,d,e,f,g,h,i){var j=a.Node.all,k=(a.Event,a.DOM,a.UA,!0),l=i,m={attrName:"data-valid",attrTipParent:"data-parent",attrDisable:"data-disable",attrReadonly:"readonly",isReadonly:!1,isAllTip:!0,tipClass:".tip",msg:{tpl:'<div class="tip tip-error">{{msg}}</div>'}};return a.augment(Validate,{constructor:Validate,version:"1.0",_init:function(b,c){var d=this;d.cache={},d.cfg=a.merge(m,c),d.$ele=j(b),d.$list=d._getNodeList(d.$ele),d.cache.reg=d.getRegexp(),d._bindEvent()},_getNodeList:function(a){var b=this,c=a.all("input,select,textarea"),d=[],e=b.cfg,f=e.attrName;return c.each(function(a){var b=a.attr(f);b&&d.push(a)}),d},_bindEvent:function(){var b=this;a.each(b.$list,function(a){a.on("blur",function(){"readonly"===a.attr("readonly")||a.fire("keyup")})}),b.$ele.on("keyup",function(a){var c=a.target,d=b.cfg,e=j(c),f=e.attr(d.attrDisable),g=e.attr(d.attrName),h=e.attr(d.attrReadonly);if(g){if("true"==f)return;if(d.isReadonly&&h)return;g&&b._regEvent(e,g)}})},_readonlyEvent:function(){},_regEvent:function(b,c){var d,e=this,f=(e.cfg,e._json(c)),g=e.cache.reg,h=!1;"object"==typeof f&&a.each(f,function(c,i){if(h)return!1;var j=f[i];if("false"!==j){var l,m=b.val().replace(/(^\s*)|(\s*$)/g,""),n=g[i];"object"==typeof n?(l=a.isObject(j)?j:n,-1!=m.search(n.reg)?(l=n.sucmsg?n.sucmsg:"",e._setTpl(b,{msg:l})):(l=l.errmsg?l.errmsg:"",e._setTpl(b,{msg:l}),k=!1,h=!0)):"function"==typeof n&&(d=a.isArray(j)?j.concat(m):[].concat(m),l=n.apply(b,d),l?(k=!1,h=!0):l="",e._setTpl(b,{msg:l}))}})},_json:function(a){return new Function("return"+a)()},_getTpl:function(a){var b=this,c=b.cfg.msg.tpl;return new g(c).render(a)},_removeTpl:function(a){var b=this,c=b.getTip(a.parent());0!=c.length&&b._renderHTML(c,"")},_appendTpl:function(a,b){a.append(b)},_renderHTML:function(a,b){a.html(b)},_setTpl:function(a,b){var c,d,e=this,f=e.cfg,g=!0;if(a.attr(f.attrTipParent)){var h=a.attr(f.attrTipParent);c=e.getTip(j(h)),g=!1}else c=e.getTip(a.parent());0!=c.length?(d=b.msg,e._renderHTML(c,d)):(c=g?e.getTipParent(a):j(h),d=e._getTpl(b),e._appendTpl(c,d))},getTipParent:function(a){return a.parent()},getTip:function(a){return a.all(this.cfg.tipClass)},_getAttr:function(){var b=this,c=b.cfg,d=[];return a.each(b.$list,function(a){var b=new Function("return "+a.attr(c.attrName))();d.push(b)}),d},getRegexp:function(){return l},add:function(){},addRule:function(b){a.mix(l,b)},delRule:function(a){delete l[a]},disable:function(a){var b=this,c=b.cfg,d=j(a);d.val(""),d.attr(c.attrDisable,"true"),b._removeTpl(d)},enable:function(a){var b=this,c=b.cfg,d=j(a);d.attr(c.attrDisable,"false")},valid:function(){{var b=this;b.cfg}return k=!0,arguments[0]?j(arguments[0]).fire("keyup"):a.each(b.$list,function(a){return a.fire("keyup"),b.cfg.isAllTip||1==k?void 0:(a.fire("focus"),!1)}),k}}),Validate},{requires:["event","node","dom","ajax","sizzle","xtemplate","./formModle","./regexp/formAuth-zh_CN"]});