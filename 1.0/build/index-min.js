/*!build time : 2014-04-20 5:18:09 PM*/
KISSY.add(function(a,b,c,d,e,f,g,h,i){function j(){this._init.apply(this,arguments)}var k=a.Node.all,l=(a.Event,a.DOM,a.UA,!0),m=i,n={attrName:"data-valid",attrTipParent:"data-parent",attrDisable:"data-disable",attrReadonly:"readonly",isReadonly:!1,isAllTip:!0,tipClass:".tip",msg:{tpl:'<div class="tip tip-error">{{msg}}</div>'}};return a.augment(j,{constructor:j,version:"1.0",_init:function(b,c){var d=this;d.cache={},d.cfg=a.merge(n,c),d.$ele=k(b),d.$list=d._getNodeList(d.$ele),d.cache.reg=d.getRegexp(),d._bindEvent()},_getNodeList:function(a){var b=this,c=a.all("input,select,textarea"),d=[],e=b.cfg,f=e.attrName;return c.each(function(a){var b=a.attr(f);b&&d.push(a)}),d},_bindEvent:function(){var b=this;a.each(b.$list,function(a){a.on("blur",function(){"readonly"===a.attr("readonly")||a.fire("keyup")})}),b.$ele.on("keyup",function(a){var c=a.target,d=b.cfg,e=k(c),f=e.attr(d.attrDisable),g=e.attr(d.attrName),h=e.attr(d.attrReadonly);if(g){if("true"==f)return;if(d.isReadonly&&h)return;g&&b._regEvent(e,g)}})},_readonlyEvent:function(){},_regEvent:function(b,c){var d,e=this,f=(e.cfg,e._json(c)),g=e.cache.reg,h=!1;"object"==typeof f&&a.each(f,function(c,i){if(h)return!1;var j=f[i];if("false"!==j){var k,m=b.val().replace(/(^\s*)|(\s*$)/g,""),n=g[i];"object"==typeof n?(k=a.isObject(j)?j:n,-1!=m.search(n.reg)?(k=n.sucmsg?n.sucmsg:"",e._setTpl(b,{msg:k})):(k=k.errmsg?k.errmsg:"",e._setTpl(b,{msg:k}),l=!1,h=!0)):"function"==typeof n&&(d=a.isArray(j)?j.concat(m):[].concat(m),k=n.apply(b,d),k?(l=!1,h=!0):k="",e._setTpl(b,{msg:k}))}})},_json:function(a){return new Function("return"+a)()},_getTpl:function(a){var b=this,c=b.cfg.msg.tpl;return new g(c).render(a)},_removeTpl:function(a){var b=this,c=b.getTip(a.parent());0!=c.length&&b._renderHTML(c,"")},_appendTpl:function(a,b){a.append(b)},_renderHTML:function(a,b){a.html(b)},_setTpl:function(a,b){var c,d,e=this,f=e.cfg,g=!0;if(a.attr(f.attrTipParent)){var h=a.attr(f.attrTipParent);c=e.getTip(k(h)),g=!1}else c=e.getTip(a.parent());0!=c.length?(d=b.msg,e._renderHTML(c,d)):(c=g?e.getTipParent(a):k(h),d=e._getTpl(b),e._appendTpl(c,d))},getTipParent:function(a){return a.parent()},getTip:function(a){return a.all(this.cfg.tipClass)},_getAttr:function(){var b=this,c=b.cfg,d=[];return a.each(b.$list,function(a){var b=new Function("return "+a.attr(c.attrName))();d.push(b)}),d},getRegexp:function(){return m},add:function(){},addRule:function(b){a.mix(m,b)},delRule:function(a){delete m[a]},disable:function(a){var b=this,c=b.cfg,d=k(a);d.val(""),d.attr(c.attrDisable,"true"),b._removeTpl(d)},enable:function(a){var b=this,c=b.cfg,d=k(a);d.attr(c.attrDisable,"false")},valid:function(){{var b=this;b.cfg}return l=!0,arguments[0]?k(arguments[0]).fire("keyup"):a.each(b.$list,function(a){return a.fire("keyup"),b.cfg.isAllTip||1==l?void 0:(a.fire("focus"),!1)}),l}}),j},{requires:["event","node","dom","ajax","sizzle","xtemplate","./formModle","./regexp/formAuth-zh_CN"]});